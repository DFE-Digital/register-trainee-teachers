# see https://github.com/ankane/blazer for more info

data_sources:
  main:
    url: <%= Settings.blazer_database_url %>
    smart_variables:
      academic_year: "SELECT id, extract(year FROM start_date)::text || ' to ' || extract(year FROM end_date)::text FROM academic_cycles"
      start_academic_year: "SELECT id, extract(year FROM start_date)::text || ' to ' || extract(year FROM end_date)::text FROM academic_cycles"
      end_academic_year: "SELECT id, extract(year FROM start_date)::text || ' to ' || extract(year FROM end_date)::text FROM academic_cycles"
      allocation_subject: "SELECT id, name FROM allocation_subjects ORDER BY name asc"
      state: {
        0: "Draft",
        1: "Pending TRN",
        2: "TRN Received",
        3: "Recommended for award",
        4: "Withdrawn",
        5: "Deferred",
        6: "Awarded"
      }
      training_route: {
        0: "Assessment only",
        1: "Provider led postgrad",
        2: "Early years undergrad",
        3: "School direct tuition fee",
        4: "School direct salaried",
        5: "PG teaching apprenticeship",
        6: "Early years assessment only",
        7: "Early years salaried",
        8: "Early years postgrad",
        9: "Provider led undergrad",
        10: "Opt-in undergrad",
        11: "HPITT postgrad",
        12: "iQTS",
      }
    smart_columns:
      course_uuid: "SELECT uuid, name || ' (' || code || ')' FROM courses WHERE uuid in {value}"
      course_allocation_subject_id: "SELECT id, name FROM allocation_subjects WHERE id in {value}"
      end_academic_cycle_id: "SELECT id, extract(year FROM start_date) || ' to ' || extract(year FROM end_date) FROM academic_cycles WHERE id in {value}"
      start_academic_cycle_id: "SELECT id, extract(year FROM start_date) || ' to ' || extract(year FROM end_date) FROM academic_cycles WHERE id in {value}"
      employing_school_id: "SELECT id, name || ' (' || postcode || ')' FROM schools WHERE id in {value}"
      lead_school_id: "SELECT id, name || ' (' || postcode || ')' FROM schools WHERE id in {value}"
      trainee_state: {
        0: "Draft",
        1: "Pending TRN",
        2: "TRN Received",
        3: "Recommended for award",
        4: "Withdrawn",
        5: "Deferred",
        6: "Awarded"
      }
      trainee_study_mode: {
        0: "Part time",
        1: "Full time"
      }
      training_initiative: {
        0: "Future teaching scholars",
        1: "Maths physics chairs programme researchers in schools",
        2: "Now teach",
        3: "Transition to teach",
        4: "No initiative",
        5: "Troops to teachers"
      }
      training_route: {
        0: "Assessment only",
        1: "Provider led postgrad",
        2: "Early years undergrad",
        3: "School direct tuition fee",
        4: "School direct salaried",
        5: "PG teaching apprenticeship",
        6: "Early years assessment only",
        7: "Early years salaried",
        8: "Early years postgrad",
        9: "Provider led undergrad",
        10: "Opt-in undergrad",
        11: "HPITT postgrad",
        12: "iQTS",
      }
    linked_columns:
      slug: "/trainees/{value}"
override_csp: true
