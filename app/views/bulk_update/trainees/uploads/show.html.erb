<%= render PageTitle::View.new(text: "Upload summary") %>

<%= content_for(:breadcrumbs) do %>
  <%= render GovukComponent::BackLinkComponent.new(text: "Home", href: root_path) %>
<% end %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds-from-desktop">
    <h1 class="govuk-heading-l">
      <span class="govuk-caption-xl"><%= organisation_name %></span>
      Upload Summary
    </h1>

    <p class="govuk-body">
      You uploaded a CSV file with details of <%= pluralize(@bulk_update_trainee_upload.number_of_trainees, "trainee") %>.
    </p>

    <p class="govuk-body">
      It included:
    </p>

    <ul class="govuk-list govuk-list--bullet">
      <% if @bulk_update_trainee_upload.trainee_upload_rows.without_errors.present? %>
        <li>
          <%= pluralize(@bulk_update_trainee_upload.trainee_upload_rows.without_errors.size, "trainee") %> who can be added
        </li>
      <% end %>

      <% if @bulk_update_trainee_upload.row_errors.duplicate.present? %>
        <li>
          <%= pluralize(@bulk_update_trainee_upload.row_errors.duplicate.size, "trainee") %>
          who will not be added, as they already exist in Register
        </li>
      <% end %>

      <% if @bulk_update_trainee_upload.row_errors.validation.present? %>
        <li>
          <%= pluralize(@bulk_update_trainee_upload.row_errors.validation.size, "trainee") %>
          with errors in their details
        </li>
      <% end %>

    </ul>

    <p class="govuk-body">You need to review the errors before you can add new trainees</p>

    <%= register_form_with(
      model: @bulk_add_trainee_form,
      url: bulk_update_trainees_submissions_path(id: @bulk_update_trainee_upload.id),
    ) do |f| %>
      <%= f.govuk_submit("Submit") %>
    <% end %>
  </div>
</div>
