# frozen_string_literal: true

class MalwareScanningJob < ApplicationJob
  def perform
    uploads = Upload.where(malware_scan_result: "pending").where(created_at: ...5.minutes.ago)

    return unless uploads.any?

    uploads.find_each { |upload| MalwareScanJob.perform_later(upload_id: upload.id) }
  end
end
