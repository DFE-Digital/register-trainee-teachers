# frozen_string_literal: true

class MalwareScanningJob < ApplicationJob
  def perform
    Upload
      .where(malware_scan_result: "pending")
      .where("created_at < ?", 5.minutes.ago)
      .find_each { |upload| MalwareScanJob.perform_later(upload_id: upload.id) }
  end
end
