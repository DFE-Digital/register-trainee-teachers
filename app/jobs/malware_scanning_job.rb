# frozen_string_literal: true

class MalwareScanningJob < ApplicationJob
  def perform
    Upload
      .where(malware_scan_result: "pending")
      .where("created_at < ?", 5.minutes.ago)
      .find_each { |upload| MalwareScan.call(upload:) }
  end
end
