# frozen_string_literal: true

class FixHesaIdsSupportTicket128896 < ActiveRecord::Migration[7.0]
  DATA = {
    ["20100071390000014", "19004520/2"] => "2010460043899",
    ["19100071390000111", "19003328/2"] => "1910460055472",
    ["15100071390000010", "15000429/2"] => "1510460008296",
    ["18100071390000099", "18008455/2"] => "1810460020233",
    ["18100071390000103", "18011516/3"] => "1810460025124",
    ["19100071390000498", "19006987/2"] => "1910460061923",
    ["19100071390000133", "19005167/2"] => "1910460058624",
    ["19100071390000155", "19005659/2"] => "1910460059447",
    ["19100071390000199", "19009285/3"] => "1910460066870",
    ["19100071390000203", "19010292/2"] => "1910460068128",
    ["19100071390000247", "19011580/2"] => "1910460070741",
    ["19100071390000269", "19013848/2"] => "1910460077599",
    ["17100071390000014", "16003495/4"] => "1710460008555",
    ["19100071390000029", "18007093/3"] => "1910460005639",
    ["19100071390000317", "19001197/2"] => "1910460051902",
    ["19100071390000339", "19002547/2"] => "1910460054073",
    ["19100071390000476", "19006582/2"] => "1910460061185",
    ["19100071390000502", "19007350/2"] => "1910460062610",
    ["19100071390000513", "19008105/2"] => "1910460064201",
    ["19100071390000546", "19014593/2"] => "1910460081415",
    ["10100071390000015", "10005886/2"] => "1010461013243",
    ["18100071390000136", "18009257/2"] => "1810460021551",
    ["19100071390000409", "19003698/2"] => "1910460056055",
    ["19100071390000166", "19007730/2"] => "1910460063385",
    ["19100071390000214", "19010730/3"] => "1910460068601",
    ["19100071390000225", "19011036/3"] => "1910460069321",
    ["18100071390000011", "16010901/2"] => "1810460005148",
    ["18100071390000022", "17000470/2"] => "1810460005300",
    ["18100071390000077", "18004440/2"] => "1810460013844",
    ["18100071390000114", "19000835/3"] => "1810460039741",
    ["19100071390000328", "19001684/2"] => "1910460052839",
    ["19100071390000421", "19005186/2"] => "1910460058680",
    ["19100071390000443", "19005986/2"] => "1910460060096",
    ["17100071390000047", "17002373/2"] => "1710460013386",
    ["19100071390000306", "19000931/2"] => "1910460051625",
    ["18100071390000125", "18002027/2"] => "1810460010289",
    ["19100071390000100", "19002925/2"] => "1910460054752",
    ["16100071390000028", "16002236/2"] => "1610460011673",
    ["18100071390000033", "17006412/2"] => "1810460005964",
    ["18100071390000055", "18003590/2"] => "1810460012607",
    ["19100071390000524", "19009457/2"] => "1910460067110",
    ["06100071390000018", "06001202/3"] => "0000061329412",
    ["19100071390000270", "18009952/3"] => "1910460006142",
    ["19100071390000281", "18010147/2"] => "1910460006201",
    ["21100071390000011", "21007218/2"] => "2110460036887",
    ["14100071390000013", "14013808/2"] => "1410460037255",
    ["19100071390000177", "19008592/3"] => "1910460065172",
    ["13100071390000027", "13009581/2"] => "1310460021936",
    ["15100071390000021", "15013083/3"] => "1510460030839",
    ["17100071390000036", "17012085/3"] => "1710460029099",
    ["18100071390000044", "17009770/2"] => "1810460006385",
    ["19100071390000030", "18007328/4"] => "1910460005684",
    ["19100071390000041", "18009246/2"] => "1910460006016",
    ["19100071390000052", "19000691/2"] => "1910460051256",
    ["19100071390000373", "19002965/2"] => "1910460054855",
    ["19100071390000384", "19003064/2"] => "1910460055003",
    ["19100071390000487", "19006747/2"] => "1910460061440",
    ["17100071390000058", "17008651/2"] => "1710460023628",
    ["19100071390000074", "19002267/2"] => "1910460053364",
    ["20100071390000036", "20015200/3"] => "2010460021897",
    ["13100071390000016", "13001444/2"] => "1310460009750",
    ["19100071390000018", "18004620/2"] => "1910460005411",
    ["19100071390000351", "19002770/2"] => "1910460054486",
    ["19100071390000410", "19004501/2"] => "1910460057465",
    ["19100071390000432", "19005448/2"] => "1910460059137",
    ["19100071390000535", "19010820/2"] => "1910460068793",
    ["21100071390000044", "21014591/2"] => "2110460003177",
    ["19100071390000465", "19006245/2"] => "1910460060627",
    ["21100071390000033", "21002070/2"] => "2110460045432",
    ["21100071390000022", "21011704/2"] => "2110460028826",
    ["19100071390000085", "19002539/2"] => "1910460054051",
    ["19100071390000096", "19002782/2"] => "1910460054523",
    ["19100071390000188", "19008736/2"] => "1910460065529",
    ["19100071390000236", "19011384/2"] => "1910460070121",
    ["14100071390000024", "14013148/2"] => "1410460031781",
    ["16100071390000017", "13005647/3"] => "1610460000817",
    ["18100071390000066", "18004226/2"] => "1810460013556",
    ["19100071390000340", "19002628/2"] => "1910460054235",
    ["19100071390000454", "19006185/2"] => "1910460060465",
    ["05100071390000011", "05007069/4"] => "0000056833076",
    ["14100071390000035", "14006623/2"] => "1410460016755",
    ["19100071390000362", "19002777/2"] => "1910460054501",
    ["19100071390000395", "19003629/2"] => "1910460055911",
    ["20100071390000025", "20016067/2"] => "2010460019207",
    ["19100071390000122", "19003922/2"] => "1910460056480",
    ["19100071390000144", "19005181/2"] => "1910460058668",
  }.freeze

  def up
    Audited.audit_class.as_user("Data migration") do
      DATA.each do |(hesa_id, trainee_id), new_hesa_id|
        ActiveRecord::Base.transaction do
          trainee = Trainee.find_by(hesa_id:, trainee_id:)
          trainee&.update!(
            hesa_id: new_hesa_id,
            audit_comment: "Correction to `hesa_id` - see https://becomingateacher.zendesk.com/agent/tickets/128896",
          )
          Hesa::Student.where(hesa_id:).each do |student|
            student.update!(hesa_id: new_hesa_id)
          end
        end
      end
    end
  end

  def down
    raise ActiveRecord::IrreversibleMigration
  end
end
